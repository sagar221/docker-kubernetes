node
{
    stage('Checkout')
    {
        checkout([$class: 'GitSCM',
        branches: [[name: '*/master']],
        doGenerateSubmoduleConfigurations: false,
        extensions: [],
        submoduleCfg: [],
        userRemoteConfigs: [[
            credentialsId: 'jenkins_kube',
            url: 'https://github.com/abhijitsingamaneni/Jenkins_with_Kubernetes.git']]])

    }
    
    stage('Docker file build')
    {
        sh 'ls -l'
        sh "sudo docker build -t abhijit1417/maven:${env.BUILD_NUMBER} ."
    }
    
    stage('push to docker registory')
    {
        // This step should not normally be used in your script. Consult the inline help for details.
        withDockerRegistry([credentialsId: 'c085882d-5c39-48bf-a974-0e578e595d9e', url: 'https://registry.hub.docker.com']) {
           sh "sudo docker push abhijit1417/maven:${env.BUILD_NUMBER}"
        }
    }
}node
{
    stage('Checkout')
    {
        checkout([$class: 'GitSCM',
        branches: [[name: '*/master']],
        doGenerateSubmoduleConfigurations: false,
        extensions: [],
        submoduleCfg: [],
        userRemoteConfigs: [[
            credentialsId: 'jenkins_kube',
            url: 'https://github.com/sagar221/docker-kubernetes.git']]])

    }
    
    stage('Docker file build')
    {
        sh 'ls -l'
        sh "sudo docker build -t sagar221/maven:${env.BUILD_NUMBER} ."
    }
    
    stage('push to docker registory')
    {
        // This step should not normally be used in your script. Consult the inline help for details.
        withDockerRegistry([credentialsId: 'c085882d-5c39-48bf-a974-0e578e595d9e', url: 'https://registry.hub.docker.com']) {
           sh "sudo docker push sagar221/maven:${env.BUILD_NUMBER}"
        }
    }
}
